# Code in R (v4.3.1) for the paper: "Psychometric validation of the Hospital Stress Questionnaire"

# Load packages and survey response data
install.packages("tidyverse")
library(tidyverse)
install.packages("psych")
library(psych)
install.packages("readr")
library(readr)
vdata <- read_csv("vdata.csv")
View(vdata)

# Set N/A values (i.e. values of 11) in HSQ equal to 1
vdata <- vdata %>% mutate_at(vars(starts_with("HSQ_")), ~ ifelse(. == 11, 1, .))

# Calculate a total HSQ score for each participant
vdata <- vdata %>% mutate(HSQ_total = rowSums(across(HSQ_1:HSQ_67)))

# Reverse code items 4, 5, 7, and 8 of PSS-10
reverse_columns <- c("PSS_4", "PSS_5", "PSS_7", "PSS_8")
vdata[, reverse_columns] <- 4 - vdata[, reverse_columns]

# Calculate a total PSS-10 score for each participant
vdata <- vdata %>% mutate(PSS_total = rowSums(across(PSS_1:PSS_10)))

# Descriptive statistics
vdata %>% summarise(Mean = mean(HSQ_total),
                   SD = sd(HSQ_total),
                   Median = median(HSQ_total),
                   Minimum = min(HSQ_total),
                   Maximum = max(HSQ_total))
vdata %>% summarise(Mean = mean(age_c),
                   SD = sd(age_c),
                   Median = median(age_c),
                   Minimum = min(age_c),
                   Maximum = max(age_c))
vdata %>% summarise(Mean = mean(age_h),
                   SD = sd(age_h),
                   Median = median(age_h),
                   Minimum = min(age_h),
                   Maximum = max(age_h))
vdata %>% summarise(Mean = mean(stays_life, na.rm = T),
                   SD = sd(stays_life, na.rm = T),
                   Median = median(stays_life, na.rm = T),
                   Minimum = min(stays_life, na.rm = T),
                   Maximum = max(stays_life, na.rm = T))
vdata %>% summarise(Mean = mean(stays_year, na.rm = T),
                   SD = sd(stays_year, na.rm = T),
                   Median = median(stays_year, na.rm = T),
                   Minimum = min(stays_year, na.rm = T),
                   Maximum = max(stays_year, na.rm = T))
vdata %>% summarise(Mean = mean(LOS, na.rm = T),
                   SD = sd(LOS, na.rm = T),
                   Median = median(LOS, na.rm = T),
                   Minimum = min(LOS, na.rm = T),
                   Maximum = max(LOS, na.rm = T))
vdata %>% count(sex)
vdata %>% count(gender)
vdata %>% count(ethnicity)
vdata %>% count(education)
vdata %>% count(marital)
vdata %>% count(surgery)
vdata %>% count(planned)



# TEST-RETEST
retest <- read_csv("retest_r.csv")
cor.test(retest$TOTAL1, retest$TOTAL2)
